<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CineVibe - Match Your Mood with Perfect Movies</title>
  <meta name="description" content="Discover movies that match your mood and weather. Personalized recommendations from your favorite streaming platforms.">
  <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      /* CineVibe Cinema Theme */
      --background: hsl(15, 20%, 97%);
      --foreground: hsl(15, 15%, 15%);
      --card: hsl(0, 0%, 100%);
      --primary: hsl(345, 65%, 25%);
      --primary-foreground: hsl(15, 20%, 97%);
      --secondary: hsl(15, 100%, 95%);
      --secondary-foreground: hsl(345, 65%, 25%);
      --muted: hsl(15, 10%, 92%);
      --muted-foreground: hsl(15, 10%, 45%);
      --accent: hsl(25, 95%, 65%);
      --accent-foreground: hsl(15, 15%, 15%);
      --weather-bg: hsl(15, 100%, 92%);
      --weather-border: hsl(15, 80%, 85%);
      --border: hsl(15, 20%, 88%);
      --destructive: hsl(0, 84%, 60%);
      --success: hsl(120, 60%, 50%);
    }

    body {
      font-family: 'Rubik', sans-serif;
      background-color: var(--background);
      color: var(--foreground);
      line-height: 1.6;
      overflow-x: hidden;
    }

    .smooth-transition {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .hover-lift:hover {
      transform: translateY(-4px);
    }

    .cinema-gradient {
      background: linear-gradient(135deg, var(--background), var(--secondary));
    }

    .hero-gradient {
      background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
    }

    .glow-accent {
      box-shadow: 0 0 20px hsla(25, 95%, 65%, 0.3);
    }

    /* Weather Box */
    .weather-box {
      position: fixed;
      top: 1rem;
      left: 1rem;
      z-index: 1000;
      background: var(--weather-bg);
      border: 2px solid var(--weather-border);
      border-radius: 16px;
      padding: 1rem;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      backdrop-filter: blur(10px);
      max-width: 280px;
    }

    .weather-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 0.5rem;
    }

    .weather-icon {
      width: 1.25rem;
      height: 1.25rem;
    }

    .weather-location {
      font-weight: 600;
      font-size: 0.875rem;
    }

    .weather-temp {
      font-size: 1.5rem;
      font-weight: 800;
      color: var(--primary);
    }

    .weather-condition {
      font-size: 0.875rem;
      color: var(--muted-foreground);
      margin-bottom: 0.5rem;
    }

    .weather-quote {
      font-size: 0.75rem;
      color: var(--muted-foreground);
      font-style: italic;
      line-height: 1.4;
    }

    /* Hero Section */
    .hero-section {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }

    .hero-bg-pattern {
      position: absolute;
      inset: 0;
      opacity: 0.05;
      background: linear-gradient(135deg, var(--primary), transparent, var(--accent));
    }

    .hero-content {
      text-align: center;
      max-width: 800px;
      padding: 2rem;
      position: relative;
      z-index: 10;
    }

    .hero-title {
      font-size: clamp(2.5rem, 8vw, 4.5rem);
      font-weight: 900;
      line-height: 1.1;
      margin-bottom: 1.5rem;
    }

    .hero-accent {
      color: var(--accent);
    }

    .hero-description {
      font-size: clamp(1.125rem, 3vw, 1.5rem);
      color: var(--muted-foreground);
      margin-bottom: 2rem;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }

    .hero-buttons {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      align-items: center;
    }

    @media (min-width: 640px) {
      .hero-buttons {
        flex-direction: row;
        justify-content: center;
      }
    }

    /* Buttons */
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      padding: 0.75rem 2rem;
      border-radius: 2rem;
      font-weight: 700;
      font-size: 1rem;
      text-decoration: none;
      border: none;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .btn-primary {
      background: var(--hero-gradient);
      color: white;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
    }

    .btn-primary:hover {
      transform: scale(1.05);
      box-shadow: 0 8px 32px rgba(249, 132, 74, 0.4);
    }

    .btn-ghost {
      background: transparent;
      color: var(--foreground);
      border: 2px solid transparent;
    }

    .btn-ghost:hover {
      color: var(--accent);
      border-color: var(--accent);
    }

    .btn-continue {
      background: var(--hero-gradient);
      color: white;
      padding: 1rem 3rem;
      font-size: 1.125rem;
    }

    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none !important;
    }

    /* Sections */
    .section {
      padding: 4rem 2rem;
      border-top: 1px solid var(--border);
    }

    .section-secondary {
      background: var(--secondary);
    }

    .section-header {
      text-align: center;
      margin-bottom: 3rem;
    }

    .section-title {
      font-size: 2.5rem;
      font-weight: 800;
      margin-bottom: 1rem;
    }

    .section-description {
      color: var(--muted-foreground);
      font-size: 1.125rem;
      max-width: 600px;
      margin: 0 auto;
    }

    /* Gender Selection */
    .gender-grid {
      display: flex;
      justify-content: center;
      gap: 2rem;
      flex-wrap: wrap;
    }

    .gender-option {
      text-align: center;
      cursor: pointer;
    }

    .gender-avatar {
      width: 180px;
      height: 180px;
      border-radius: 24px;
      border: 4px solid transparent;
      transition: all 0.3s ease;
      background: linear-gradient(135deg, #e3f2fd, #f3e5f5);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 4rem;
      margin-bottom: 1rem;
    }

    .gender-option:hover .gender-avatar {
      border-color: var(--accent);
      transform: scale(1.05);
    }

    .gender-option.selected .gender-avatar {
      border-color: var(--accent);
      box-shadow: 0 0 20px hsla(25, 95%, 65%, 0.3);
    }

    .gender-label {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      font-weight: 600;
      font-size: 1.125rem;
    }

    .gender-radio {
      width: 1.25rem;
      height: 1.25rem;
      accent-color: var(--accent);
    }

    /* Platform Selection */
    .platform-header {
      text-align: center;
      margin-bottom: 2rem;
    }

    .toggle-btn {
      background: none;
      border: none;
      color: var(--accent);
      font-weight: 700;
      font-size: 1rem;
      cursor: pointer;
      margin-bottom: 2rem;
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      transition: all 0.3s ease;
    }

    .toggle-btn:hover {
      background: var(--accent);
      color: white;
    }

    .platform-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 1.5rem;
      max-width: 1000px;
      margin: 0 auto;
    }

    .platform-card {
      background: var(--card);
      border: 2px solid var(--border);
      border-radius: 20px;
      padding: 2rem 1rem;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      min-height: 200px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .platform-card:hover {
      transform: translateY(-4px);
      border-color: var(--accent);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    }

    .platform-card.selected {
      border-color: var(--accent);
      background: linear-gradient(135deg, var(--card), var(--secondary));
      box-shadow: 0 0 20px hsla(25, 95%, 65%, 0.2);
    }

    .platform-logo {
      width: 80px;
      height: 80px;
      border-radius: 12px;
      margin-bottom: 1rem;
      background: linear-gradient(135deg, #667eea, #764ba2);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 0.875rem;
    }

    .platform-name {
      font-weight: 600;
      font-size: 1.125rem;
      margin-bottom: 1rem;
    }

    .platform-checkbox {
      width: 1.25rem;
      height: 1.25rem;
      accent-color: var(--accent);
    }

    /* Final Section */
    .final-section {
      text-align: center;
      padding: 4rem 2rem;
    }

    .preferences-summary {
      margin-top: 1.5rem;
      font-size: 0.875rem;
      color: var(--muted-foreground);
    }

    .preferences-summary p {
      margin: 0.25rem 0;
    }

    .preferences-value {
      font-weight: 600;
      color: var(--foreground);
      text-transform: capitalize;
    }

    /* Toast Notifications */
    .toast {
      position: fixed;
      top: 2rem;
      right: 2rem;
      background: var(--card);
      border: 2px solid var(--border);
      border-radius: 12px;
      padding: 1rem;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      z-index: 1000;
      max-width: 400px;
      transform: translateX(100%);
      transition: transform 0.3s ease;
    }

    .toast.show {
      transform: translateX(0);
    }

    .toast.error {
      border-color: var(--destructive);
      background: linear-gradient(135deg, var(--card), hsl(0, 84%, 95%));
    }

    .toast.success {
      border-color: var(--success);
      background: linear-gradient(135deg, var(--card), hsl(120, 60%, 95%));
    }

    .toast-title {
      font-weight: 700;
      margin-bottom: 0.25rem;
    }

    .toast-description {
      font-size: 0.875rem;
      color: var(--muted-foreground);
    }

    /* Loading Animation */
    .loading-spinner {
      width: 1.25rem;
      height: 1.25rem;
      border: 2px solid transparent;
      border-top: 2px solid currentColor;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Scroll Indicator */
    .scroll-indicator {
      position: absolute;
      bottom: 2rem;
      left: 50%;
      transform: translateX(-50%);
      animation: bounce 2s infinite;
    }

    .scroll-mouse {
      width: 1.5rem;
      height: 2.5rem;
      border: 2px solid var(--muted-foreground);
      border-radius: 1rem;
      display: flex;
      justify-content: center;
      padding-top: 0.5rem;
    }

    .scroll-dot {
      width: 0.25rem;
      height: 0.75rem;
      background: var(--muted-foreground);
      border-radius: 0.125rem;
      animation: pulse 2s infinite;
    }

    @keyframes bounce {
      0%, 20%, 50%, 80%, 100% { transform: translateX(-50%) translateY(0); }
      40% { transform: translateX(-50%) translateY(-10px); }
      60% { transform: translateX(-50%) translateY(-5px); }
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.3; }
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .weather-box {
        position: relative;
        margin: 1rem;
        max-width: none;
      }

      .gender-grid {
        gap: 1rem;
      }

      .gender-avatar {
        width: 120px;
        height: 120px;
        font-size: 2.5rem;
      }

      .platform-grid {
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      }

      .section {
        padding: 2rem 1rem;
      }
    }
  </style>
</head>
<body>
  <!-- Weather Box -->
  <div class="weather-box">
    <div class="weather-header">
      <div class="weather-icon" id="weatherIcon">☁️</div>
      <div>
        <div class="weather-location" id="location">Detecting location...</div>
        <div class="weather-temp" id="temperature">--°C</div>
      </div>
    </div>
    <div class="weather-condition" id="condition">Fetching weather...</div>
    <div class="weather-quote" id="weatherQuote">...</div>
  </div>

  <!-- Hero Section -->
  <section class="hero-section cinema-gradient">
    <div class="hero-bg-pattern"></div>
    <div class="hero-content">
      <h1 class="hero-title">
        Match your <span class="hero-accent">mood</span><br>
        with the perfect movie
      </h1>
      <p class="hero-description">
        CineVibe personalizes your streaming journey — discover films that fit your vibe, emotions, and favorite platforms.
      </p>
      <div class="hero-buttons">
        <button class="btn btn-primary" onclick="scrollToOnboarding()">
          ▶️ Start Exploring
        </button>
        <button class="btn btn-ghost" onclick="scrollToOnboarding()">
          Let's Get Started →
        </button>
      </div>
    </div>
    <div class="scroll-indicator">
      <div class="scroll-mouse">
        <div class="scroll-dot"></div>
      </div>
    </div>
  </section>

  <!-- Gender Selection -->
  <section class="section section-secondary" id="genderSection">
    <div class="section-header">
      <h2 class="section-title">Tell Us a Bit About You</h2>
      <p class="section-description">
        To make your movie experience even more accurate, we consider your preferences — including gender.<br>
        This helps us fine-tune recommendations that reflect your emotional vibe and streaming taste.
      </p>
    </div>
    
    <div class="gender-grid">
      <label class="gender-option" data-gender="male">
        <div class="gender-avatar">👨</div>
        <div class="gender-label">
          <input type="radio" name="gender" value="male" class="gender-radio">
          Male
        </div>
      </label>
      <label class="gender-option" data-gender="female">
        <div class="gender-avatar">👩</div>
        <div class="gender-label">
          <input type="radio" name="gender" value="female" class="gender-radio">
          Female
        </div>
      </label>
      <label class="gender-option" data-gender="other">
        <div class="gender-avatar">👤</div>
        <div class="gender-label">
          <input type="radio" name="gender" value="other" class="gender-radio">
          Other
        </div>
      </label>
    </div>
  </section>

  <!-- Platform Selection -->
  <section class="section">
    <div class="section-header">
      <h2 class="section-title">Select Your Preferred OTT Platforms</h2>
      <p class="section-description">
        Choose from your favorite streaming services. Tailor your experience based on what you love to watch.
      </p>
    </div>

    <div class="platform-header">
      <button class="toggle-btn" onclick="toggleAllPlatforms()">Select All</button>
    </div>

    <div class="platform-grid" id="platformGrid">
      <label class="platform-card" data-platform="netflix">
        <div class="platform-logo" style="background: linear-gradient(135deg, #e50914, #b20710);">Netflix</div>
        <div class="platform-name">Netflix</div>
        <input type="checkbox" value="netflix" class="platform-checkbox">
      </label>
      
      <label class="platform-card" data-platform="prime">
        <div class="platform-logo" style="background: linear-gradient(135deg, #00a8e1, #0073aa);">Prime</div>
        <div class="platform-name">Prime Video</div>
        <input type="checkbox" value="prime" class="platform-checkbox">
      </label>

      <label class="platform-card" data-platform="hotstar">
        <div class="platform-logo" style="background: linear-gradient(135deg, #1f80e0, #0f4c8c);">Hotstar</div>
        <div class="platform-name">Disney+ Hotstar</div>
        <input type="checkbox" value="hotstar" class="platform-checkbox">
      </label>

      <label class="platform-card" data-platform="jiocinema">
        <div class="platform-logo" style="background: linear-gradient(135deg, #8a2be2, #6a1b9a);">JioCinema</div>
        <div class="platform-name">JioCinema</div>
        <input type="checkbox" value="jiocinema" class="platform-checkbox">
      </label>

      <label class="platform-card" data-platform="sonyliv">
        <div class="platform-logo" style="background: linear-gradient(135deg, #4285f4, #1565c0);">SonyLIV</div>
        <div class="platform-name">SonyLIV</div>
        <input type="checkbox" value="sonyliv" class="platform-checkbox">
      </label>

      <label class="platform-card" data-platform="zee5">
        <div class="platform-logo" style="background: linear-gradient(135deg, #7b1fa2, #4a148c);">Zee5</div>
        <div class="platform-name">Zee5</div>
        <input type="checkbox" value="zee5" class="platform-checkbox">
      </label>

      <label class="platform-card" data-platform="appletv">
        <div class="platform-logo" style="background: linear-gradient(135deg, #000000, #333333);">Apple TV+</div>
        <div class="platform-name">Apple TV+</div>
        <input type="checkbox" value="appletv" class="platform-checkbox">
      </label>

      <label class="platform-card" data-platform="mxplayer">
        <div class="platform-logo" style="background: linear-gradient(135deg, #ff6b35, #f7931e);">MX Player</div>
        <div class="platform-name">MX Player</div>
        <input type="checkbox" value="mxplayer" class="platform-checkbox">
      </label>

      <label class="platform-card" data-platform="hungama">
        <div class="platform-logo" style="background: linear-gradient(135deg, #ff4081, #e91e63);">Hungama</div>
        <div class="platform-name">Hungama Play</div>
        <input type="checkbox" value="hungama" class="platform-checkbox">
      </label>
    </div>
  </section>

  <!-- Final Section -->
  <section class="final-section">
    <button class="btn btn-continue" id="continueBtn" onclick="handleContinue()">
      <span id="continueText">✅ Continue to CineVibe →</span>
      <div id="loadingSpinner" class="loading-spinner" style="display: none;"></div>
    </button>
    
    <div class="preferences-summary" id="preferencesSummary" style="display: none;">
      <p>Gender: <span class="preferences-value" id="selectedGender">-</span></p>
      <p>Platforms: <span class="preferences-value" id="selectedPlatformCount">0 selected</span></p>
    </div>
  </section>

  <!-- Toast Container -->
  <div id="toastContainer"></div>

  <script>
    // Global State
    let selectedGender = '';
    let selectedPlatforms = [];
    let allPlatformsSelected = false;
    let isSubmitting = false;

    // Weather API
    const weatherApiKey = "c6c0aa89af984e0ba386ed1961b57b43";

    // Initialize App
    document.addEventListener('DOMContentLoaded', function() {
      initializeWeather();
      initializeGenderSelection();
      initializePlatformSelection();
      updateUI();
    });

    // Weather Functions
    function initializeWeather() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
          (position) => {
            fetchWeather(position.coords.latitude, position.coords.longitude);
          },
          () => {
            setWeatherError();
          }
        );
      } else {
        setWeatherError();
      }
    }

    function fetchWeather(lat, lon) {
      fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${weatherApiKey}&units=metric`)
        .then(response => response.json())
        .then(data => {
          updateWeatherDisplay(data);
        })
        .catch(() => {
          setWeatherError();
        });
    }

    function updateWeatherDisplay(data) {
      const location = document.getElementById('location');
      const temperature = document.getElementById('temperature');
      const condition = document.getElementById('condition');
      const weatherQuote = document.getElementById('weatherQuote');
      const weatherIcon = document.getElementById('weatherIcon');

      location.textContent = data.name;
      temperature.textContent = Math.round(data.main.temp) + '°C';
      condition.textContent = data.weather[0].main;
      
      const quote = getWeatherQuote(data.weather[0].main);
      weatherQuote.textContent = quote;
      
      const icon = getWeatherIcon(data.weather[0].main);
      weatherIcon.textContent = icon;
    }

    function setWeatherError() {
      document.getElementById('location').textContent = 'Location unavailable';
      document.getElementById('temperature').textContent = '--°C';
      document.getElementById('condition').textContent = 'Unknown';
      document.getElementById('weatherQuote').textContent = "We'll still find something perfect for your mood.";
      document.getElementById('weatherIcon').textContent = '🌤️';
    }

    function getWeatherIcon(condition) {
      const icons = {
        'Clear': '☀️',
        'Clouds': '☁️',
        'Rain': '🌧️',
        'Thunderstorm': '⛈️',
        'Snow': '❄️',
        'Mist': '🌫️',
        'Fog': '🌫️'
      };
      return icons[condition] || '🌤️';
    }

    function getWeatherQuote(condition) {
      const quotes = {
        'Clear': "Sunshine calls for a cheerful story.",
        'Clouds': "A cloudy day pairs well with something thoughtful.",
        'Rain': "Rainy outside? Let's find you something cozy.",
        'Thunderstorm': "Thunder calls for something dramatic.",
        'Snow': "Snowy vibes? Warm up with a heartfelt classic.",
        'Mist': "A little fog, a lot of mystery — let's dive in.",
        'Fog': "A little fog, a lot of mystery — let's dive in."
      };
      return quotes[condition] || "Every day deserves the perfect movie.";
    }

    // Navigation Functions
    function scrollToOnboarding() {
      document.getElementById('genderSection').scrollIntoView({
        behavior: 'smooth',
        block: 'start'
      });
    }

    // Gender Selection Functions
    function initializeGenderSelection() {
      const genderOptions = document.querySelectorAll('.gender-option');
      
      genderOptions.forEach(option => {
        const radio = option.querySelector('input[type="radio"]');
        
        option.addEventListener('click', function() {
          const gender = this.getAttribute('data-gender');
          selectGender(gender);
        });

        radio.addEventListener('change', function() {
          if (this.checked) {
            selectGender(this.value);
          }
        });
      });
    }

    function selectGender(gender) {
      selectedGender = gender;
      
      // Update visual state
      document.querySelectorAll('.gender-option').forEach(option => {
        option.classList.remove('selected');
      });
      
      const selectedOption = document.querySelector(`[data-gender="${gender}"]`);
      if (selectedOption) {
        selectedOption.classList.add('selected');
        selectedOption.querySelector('input').checked = true;
      }
      
      updateUI();
    }

    // Platform Selection Functions
    function initializePlatformSelection() {
      const platformCards = document.querySelectorAll('.platform-card');
      
      platformCards.forEach(card => {
        const checkbox = card.querySelector('input[type="checkbox"]');
        
        card.addEventListener('click', function(e) {
          if (e.target.type !== 'checkbox') {
            checkbox.checked = !checkbox.checked;
          }
          togglePlatform(checkbox.value, checkbox.checked);
        });

        checkbox.addEventListener('change', function() {
          togglePlatform(this.value, this.checked);
        });
      });
    }

    function togglePlatform(platform, isSelected) {
      if (isSelected) {
        if (!selectedPlatforms.includes(platform)) {
          selectedPlatforms.push(platform);
        }
      } else {
        selectedPlatforms = selectedPlatforms.filter(p => p !== platform);
      }
      
      updatePlatformVisuals();
      updateUI();
    }

    function updatePlatformVisuals() {
      document.querySelectorAll('.platform-card').forEach(card => {
        const platform = card.getAttribute('data-platform');
        const checkbox = card.querySelector('input[type="checkbox"]');
        
        if (selectedPlatforms.includes(platform)) {
          card.classList.add('selected');
          checkbox.checked = true;
        } else {
          card.classList.remove('selected');
          checkbox.checked = false;
        }
      });
    }

    function toggleAllPlatforms() {
      const toggleBtn = document.querySelector('.toggle-btn');
      const allPlatforms = Array.from(document.querySelectorAll('.platform-card')).map(card => 
        card.getAttribute('data-platform')
      );

      if (allPlatformsSelected) {
        selectedPlatforms = [];
        toggleBtn.textContent = 'Select All';
        allPlatformsSelected = false;
      } else {
        selectedPlatforms = [...allPlatforms];
        toggleBtn.textContent = 'Deselect All';
        allPlatformsSelected = true;
      }

      updatePlatformVisuals();
      updateUI();
    }

    // UI Update Functions
    function updateUI() {
      const summary = document.getElementById('preferencesSummary');
      const genderSpan = document.getElementById('selectedGender');
      const platformCountSpan = document.getElementById('selectedPlatformCount');

      if (selectedGender || selectedPlatforms.length > 0) {
        summary.style.display = 'block';
        genderSpan.textContent = selectedGender || 'Not specified';
        platformCountSpan.textContent = `${selectedPlatforms.length} selected`;
      } else {
        summary.style.display = 'none';
      }
    }

  

    // Form Submission
    async function handleContinue() {
  if (isSubmitting) return;

  if (!selectedGender) {
    showToast('Please select your gender preference', 'This helps us personalize your movie recommendations.', 'error');
    return;
  }

  if (selectedPlatforms.length === 0) {
    showToast('Please select at least one streaming platform', 'We need to know which platforms you have access to.', 'error');
    return;
  }

  isSubmitting = true;
  updateSubmitButton(true);

  try {
    await new Promise(resolve => setTimeout(resolve, 2000));

    const preferences = {
      gender: selectedGender,
      platforms: selectedPlatforms,
      onboardingCompleted: true,
      timestamp: new Date().toISOString()
    };

    localStorage.setItem('cinevibe-preferences', JSON.stringify(preferences));

    showToast('Preferences saved successfully!', 'Welcome to CineVibe! Let\'s find your perfect movie.', 'success');

    // ✅ ADD THIS HERE
    setTimeout(() => {
      window.location.href = "./prompt.html";
    }, 2000);

  } catch (error) {
    showToast('Something went wrong', 'Please try again in a moment.', 'error');
  } finally {
    isSubmitting = false;
    updateSubmitButton(false);
  }
}


    function updateSubmitButton(loading) {
      const btn = document.getElementById('continueBtn');
      const text = document.getElementById('continueText');
      const spinner = document.getElementById('loadingSpinner');

      if (loading) {
        btn.disabled = true;
        text.textContent = 'Saving Preferences...';
        spinner.style.display = 'inline-block';
      } else {
        btn.disabled = false;
        text.textContent = 'Continue to CineVibe →';
        spinner.style.display = 'none';
      }
    }
    


    // Toast Notifications
    function showToast(title, description, type = 'info') {
      const container = document.getElementById('toastContainer');
      
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      toast.innerHTML = `
        <div class="toast-title">${title}</div>
        <div class="toast-description">${description}</div>
      `;

      container.appendChild(toast);

      // Show toast
      setTimeout(() => {
        toast.classList.add('show');
      }, 100);

      // Hide toast after 5 seconds
      setTimeout(() => {
        toast.classList.remove('show');
        setTimeout(() => {
          container.removeChild(toast);
        }, 300);
      }, 5000);
    }

    // Smooth scrolling for older browsers
    function smoothScroll(target) {
      const element = document.querySelector(target);
      if (element) {
        element.scrollIntoView({
          behavior: 'smooth',
          block: 'start'
        });
      }
    }
  </script>
</body>
</html>